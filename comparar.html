<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comparar Dispositivos ‚Äî Comparatech</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
</head>

<body>
  <div class="conteiner">
    <!-- HEADER -->
    <header class="header">
      <div class="logo">
        <a href="Index.html"><img src="Imagenes/Logos/logo1.png" alt="logo" width="100"></a>
        <h1>Comparatech</h1>
      </div>

      <nav class="nav">
        <div class="dropdown">
          <button>‚â°</button>
          <div class="dropdown-options">
            <a href="inicio.html">Inicio</a>
            <a href="noticias.html">Noticias</a>
            <a href="categoria.html">Categor√≠as</a>
            <a href="soporte.html">Soporte</a>
          </div>
        </div>
      </nav>
    </header>

    <!-- CONTENIDO PRINCIPAL -->
    <section class="comparison-page">
      <h2>Comparaci√≥n de dispositivos</h2>
      <div id="compare-container" class="comparison-grid"></div>
    </section>
    <button id="clear-compare" class="submit-button" style="margin:15px 0;">üîÑ Reiniciar comparaci√≥n</button>
  </div>

  <!-- SCRIPT DE COMPARACI√ìN + CALIFICACIONES -->
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const container = document.getElementById("compare-container");
    const datos = JSON.parse(localStorage.getItem("comparar"));

    if (!datos || datos.length < 2) {
      container.innerHTML = "<p class='empty-message'>‚ö†Ô∏è No hay dispositivos seleccionados para comparar.</p>";
      return;
    }

    const specs = {
      procesador: ["Snapdragon 8 Gen 3", "Apple A17 Pro", "Tensor G3", "Dimensity 9200"],
      ram: ["8 GB", "12 GB", "16 GB", "6 GB"],
      pantalla: ["6.7'' AMOLED 120Hz", "6.8'' LTPO OLED", "6.5'' Super Retina XDR"],
      bateria: ["5000 mAh", "4800 mAh", "4500 mAh", "5300 mAh"],
      camara: ["108 MP + 12 MP + 10 MP", "50 MP + 12 MP + 48 MP", "200 MP + 50 MP + 12 MP"]
    };

    container.innerHTML = datos.map((p, i) => `
      <div class="comparison-card" data-id="${i}">
        <img src="${p.imagen}" alt="${p.nombre}">
        <h3>${p.nombre}</h3>
        <p><strong>Marca:</strong> ${p.marca}</p>
        <p><strong>Precio:</strong> ${p.precio}</p>
        <hr>
        <p><strong>Procesador:</strong> ${specs.procesador[i % specs.procesador.length]}</p>
        <p><strong>RAM:</strong> ${specs.ram[i % specs.ram.length]}</p>
        <p><strong>Pantalla:</strong> ${specs.pantalla[i % specs.pantalla.length]}</p>
        <p><strong>Bater√≠a:</strong> ${specs.bateria[i % specs.bateria.length]}</p>
        <p><strong>C√°mara:</strong> ${specs.camara[i % specs.camara.length]}</p>

        <div class="rating-section">
          <h4>Califica este producto:</h4>
          <div class="stars" data-rating="0">
            <span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span><span>‚òÖ</span>
          </div>
          <textarea placeholder="Escribe tu opini√≥n..." maxlength="120"></textarea>
          <button class="submit-review">Enviar opini√≥n</button>
          <p class="average-rating">‚≠ê Promedio: <span>0.0</span>/5</p>
          <div class="reviews-list"></div>
        </div>
      </div>
    `).join("");

    // --- L√ìGICA DE CALIFICACIONES ---
    document.querySelectorAll(".comparison-card").forEach(card => {
      const id = card.dataset.id;
      const stars = card.querySelectorAll(".stars span");
      const textarea = card.querySelector("textarea");
      const btn = card.querySelector(".submit-review");
      const avgText = card.querySelector(".average-rating span");
      const reviewsList = card.querySelector(".reviews-list");

      let rating = 0;

      // seleccionar estrellas
      stars.forEach((star, idx) => {
        star.addEventListener("click", () => {
          rating = idx + 1;
          stars.forEach((s, i) => s.style.color = i < rating ? "#00bcd4" : "#555");
        });
      });

      // enviar rese√±a
      btn.addEventListener("click", () => {
        const comment = textarea.value.trim();
        if (!rating) return alert("Selecciona una calificaci√≥n.");
        if (!comment) return alert("Escribe un comentario.");

        const all = JSON.parse(localStorage.getItem("reviews") || "{}");
        if (!all[id]) all[id] = [];
        all[id].push({ stars: rating, comment });
        localStorage.setItem("reviews", JSON.stringify(all));

        textarea.value = "";
        rating = 0;
        stars.forEach(s => s.style.color = "#555");
        loadReviews();
      });

      function loadReviews() {
        const all = JSON.parse(localStorage.getItem("reviews") || "{}");
        const data = all[id] || [];
        if (data.length === 0) return;
        const avg = (data.reduce((a,b) => a + b.stars, 0) / data.length).toFixed(1);
        avgText.textContent = avg;
        reviewsList.innerHTML = data.slice(-3).map(r => 
          `<p>‚≠ê ${r.stars} ‚Äî ${r.comment}</p>`).join("");
      }

      loadReviews();
    });
  });
    // Bot√≥n para limpiar comparaci√≥n
  const clearBtn = document.getElementById("clear-compare");
  clearBtn.addEventListener("click", () => {
    localStorage.removeItem("comparar");
    alert("üîÑ Comparaci√≥n reiniciada. Vuelve a seleccionar productos.");
    location.reload();
  });

  </script>
</body>
</html>
